<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Koobs · Drive‑Thru</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Almarai:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/base.css?v=1.0.0">
  <link rel="stylesheet" href="/css/design-tokens.css?v=1.0.0">
  <link rel="stylesheet" href="/css/style.css?v=1.0.4">
  <link rel="stylesheet" href="/css/cashier.css?v=1.0.1">
  <script src="/js/device-activation.js?v=1.0.22" data-role="cashier" defer></script>
</head>
<body>
  <main class="canvas">
    <!-- UPPER STRIP -->
    <section class="upper">
      <!-- LEFT: VIDEO with PiP -->
      <div class="video-panel">
        <img class="logo-overlay" id="brandLogo" src="/images/OrderTech.png" alt="OrderTech" />
        <video id="remoteVideo" autoplay playsinline></video>
        <video id="localVideo" class="pip" autoplay muted playsinline></video>
      </div>

      <!-- RIGHT: ORDER SUMMARY -->
      <div class="order-panel">
        <div class="billCard">
          <header class="billHead" style="align-items:flex-start;">
            <h3 style="margin:0;"><span id="osnHeader" class="osn-header" style="display:none;"></span> Order Summary</h3>
            <div class="billMeta">
              <span id="statusChip" class="chip status ready">READY</span>
              <span id="netBars" class="net-bars bars-0" title="Network quality" aria-label="Network quality"></span>
              <div id="branchFlags" class="branch-flags"></div>
            </div>
          </header>
          <ul id="billItems" class="billItems"></ul>
          <footer class="billFoot">
            <div class="row total"><span>Total</span><span id="grandTotal">0.000 KWD</span></div>
          </footer>
            <div class="actions">
            <button id="resetBtn" class="btn" type="button">Reset</button>
            <button id="posterBtn" class="btn" type="button">Poster</button>
            <button id="muteBtn" class="btn" type="button">Mute</button>
            <button id="payBtn" class="btn pay" type="button">Pay</button>
          </div>
          <!-- Device Select Overlay over Bill Area -->
          <div id="deviceOverlay"></div>
        </div>
      </div>
    </section>

    <!-- MENU -->
    <section class="menu">
      <nav id="cats" class="tabs" role="tablist" aria-label="Menu categories"></nav>
      <div id="grid" class="grid"></div>
    </section>
  </main>

  <div id="optionsModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;">
    <div id="optionsCard" style="background:#fff; border-radius:12px; padding:20px; width:min(720px,92vw); max-height:90vh; overflow:auto;">
      <h3 id="optTitle" style="margin-top:0;">Choose Options</h3>
      <div id="optBody"></div>
      <div id="optBtnsRow" style="display:flex; gap:12px; margin-top:16px;">
        <button id="optCancel" class="btn">Cancel</button>
        <button id="optConfirm" class="btn">Add</button>
      </div>
    </div>
  </div>

<script src="/js/cashier-complete.js?v=1.0.28" defer></script>
<script>
  (async function(){
    try {
      const r = await fetch('/brand', { cache:'no-store' });
      if (r.ok) {
        const b = await r.json();
        if (b && b.logo_url) { const el = document.getElementById('brandLogo'); if (el) el.src = b.logo_url; }
        if (b && b.display_name) { try { document.title = b.display_name + ' · Drive‑Thru'; } catch {} }
      }
    } catch {}
  })();
</script>
</body>
</html>
